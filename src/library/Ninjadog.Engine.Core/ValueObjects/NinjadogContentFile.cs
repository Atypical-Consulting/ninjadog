// Copyright (c) 2020-2024, Atypical Consulting SRL. All rights reserved.
// This source code is proprietary and confidential.
// Unauthorized copying, modification, distribution, or use of this source code, in whole or in part,
// without express written permission from Atypical Consulting SRL is strictly prohibited.

namespace Ninjadog.Engine.Core.ValueObjects;

/// <summary>
/// Represents the content file generated by a Ninjadog template.
/// </summary>
public record NinjadogContentFile
{
    /// <summary>
    /// An empty content file.
    /// </summary>
    public static readonly NinjadogContentFile Empty = new(string.Empty, string.Empty);

    /// <summary>
    /// Initializes a new instance of the <see cref="NinjadogContentFile"/> class.
    /// </summary>
    /// <param name="fileName">The name of the file.</param>
    /// <param name="content">The content of the file.</param>
    /// <param name="category">The category of the file.</param>
    /// <param name="useDefaultLayout">A value indicating whether to use the default code layout.</param>
    public NinjadogContentFile(
        string fileName,
        string content,
        string? category = null,
        bool useDefaultLayout = true)
    {
        FileName = fileName;
        Category = category;

        if (string.IsNullOrWhiteSpace(content))
        {
            Content = "";
            IsEmpty = true;
        }
        else
        {
            var contentWithLayout = useDefaultLayout
                ? TemplateUtilities.DefaultCodeLayout(content)
                : content;

            Content = contentWithLayout;
            IsEmpty = false;
        }
    }

    /// <summary>
    /// Gets the name of the content file.
    /// </summary>
    public string FileName { get; }

    /// <summary>
    /// Gets the content of the content file.
    /// </summary>
    public string Content { get; }

    /// <summary>
    /// Gets the category of the content file.
    /// </summary>
    public string? Category { get; }

    /// <summary>
    /// Gets a value indicating whether the content is empty.
    /// </summary>
    public bool IsEmpty { get; }

    /// <summary>
    /// Gets the key of the content file.
    /// </summary>
    public string Key
        => Category != null ? $"{Category}/{FileName}" : FileName;

    /// <summary>
    /// Gets the length of the content.
    /// </summary>
    public int Length
        => Content.Length;
}
